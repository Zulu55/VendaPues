<NavigationLock OnBeforeInternalNavigation="OnBeforeInternalNavigation"></NavigationLock>

<EditForm EditContext="editContext" OnValidSubmit="OnDataAnnotationsValidatedAsync">
    <DataAnnotationsValidator />

    <MudCard>
        <div class="card-header">
            <span class="d-flex justify-content-between align-items-center w-100">
                <div>
                    <i class="bi bi-box2"></i> Crear Nuevo Producto
                </div>
                <div class="d-flex justify-content-end">
                    <MudButton Variant="Variant.Outlined" StartIcon="@Icons.Material.Filled.ArrowBack" Color="Color.Info" OnClick="ReturnAction" Class="me-2">
                        Regresar
                    </MudButton>
                    <MudButton Variant="Variant.Outlined" StartIcon="@Icons.Material.Filled.Check" Color="Color.Primary" ButtonType="ButtonType.Submit">
                        Guardar
                    </MudButton>
                </div>
            </span>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-6">
                    <div class="mb-3">
                        <MudTextField Label="Nombre"
                                      @bind-Value="@ProductDTO.Name"
                                      For="@(() => ProductDTO.Name)"
                                      Class="mb-4" />

                    </div>
                    <div class="mb-3">
                        <MudTextField Label="Descripción"
                                      @bind-Value="@ProductDTO.Description"
                                      For="@(() => ProductDTO.Description)"
                                      Class="mb-4" />
                    </div>
                    <div class="mb-3">
                        <MudTextField Label="Inventario"
                                      @bind-Value="@ProductDTO.Price"
                                      For="@(() => ProductDTO.Price)"
                                      Class="mb-4" />
                    </div>
                    <div class="mb-3">
                        <MudTextField Label="Costo"
                                      @bind-Value="@ProductDTO.Cost"
                                      For="@(() => ProductDTO.Cost)"
                                      Class="mb-4" />
                    </div>
                    <div class="mb-3">
                        <MudTextField Label="% Utilidad Esperada"
                                      @bind-Value="@ProductDTO.DesiredProfit"
                                      For="@(() => ProductDTO.DesiredProfit)"
                                      Class="mb-4" />
                    </div>
                    <div class="mb-3">
                        <MudTextField Label="Precio"
                                      @bind-Value="@ProductDTO.Stock"
                                      For="@(() => ProductDTO.Stock)"
                                      Class="mb-4" />
                    </div>
                </div>
                <div class="col-6">
                    <div class="mb-3">
                        <label>Categorías:</label>
                        <div>
                            <MultipleSelector NonSelected="nonSelected" Selected="selected" />
                        </div>
                    </div>
                    <div class="mb-3">
                        <InputImg Label="Foto" ImageSelected="ImageSelected" ImageURL="@imageUrl" />
                    </div>
                    @if (IsEdit)
                    {
                        <div class="mb-3">
                            <MudButton Variant="Variant.Outlined" StartIcon="@Icons.Material.Filled.AddAPhoto" Color="Color.Primary" OnClick="AddImageAction">
                                Imagén
                            </MudButton>
                            <MudButton Variant="Variant.Outlined" StartIcon="@Icons.Material.Filled.Delete" Color="Color.Error" OnClick="RemoveImageAction">
                                Imagén
                            </MudButton>
                        </div>
                    }
                </div>
            </div>
        </div>
    </MudCard>
</EditForm>

@if (IsEdit && ProductDTO.ProductImages is not null)
{
    <CarouselView Images="ProductDTO.ProductImages" />
}